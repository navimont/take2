{% extends "take2baseclass.html" %}

{% block content %}
    <header>
      {% if signed_in %}
        <!-- Show birthdays for signed in users -->
        {% if birthdays %}
          <h1>Birthdays</h1>
          <ul id="birthdays">
            {% for person in birthdays %}
              <li>{{ person.name }} {% if person.nickname %} ({{ person.nickname }}) {% endif %} *{{ person.birthday }}
            {% endfor %}
          </ul>
        {% endif %}
      {% else %}
        <p>You need to sign in to enter your own address book on this site (a google account will do).</p>
        <div style="width: 300px; height: 30px;"></div>
      {% endif %}
    </header>
    {% if result %}
        {% if query %}
          <header>
            <h1>Results for "{{ query|escape }}" ({{ result_size }} found):</h1>
          </header>
        {% endif %}
      {% for contact in result %}
        <article id="results">
          <aside class="contact_navigation">
            <ul>
              {% if contact.can_edit %}
                <li><a href="javascript:void(0)" onClick="post_to_url('editcontact', {'key': '{{contact.key}}'});">edit</a></li>
                <li><a href="javascript:void(0)" onClick="post_to_url('editcontact', {'key': '{{contact.key}}'});">share</a></li>
              {% else %}
                <li><a href="javascript:void(0)" onClick="post_to_url('editcontact', {'key': '{{contact.key}}'});">connect</a></li>
              {% endif %}
              <li><a href="javascript:void(0)" onClick="post_to_url('editcontact', {'key': '{{contact.key}}'});">locate</a></li>
            </ul>
          </aside>
          <header>
            <h2>
              {{ contact.name }}
              {% if contact.nickname %}
                  ({{contact.nickname}})
              {% endif %}
              {{contact.lastname}}
              {% if contact.birthday %}
                  &nbsp;*{{contact.birthday}} {{contact.birthmonth}}
              {% endif %}
            </h2>
            {% if contact.middleman_ref %}
              <h3>
                {{contact.relation}} (related through <a id="contact_link" href="/search?key={{contact.middleman_ref}}">{{contact.middleman}}</a>)
              </h3>
            {% endif %}
          </header>
          <!-- properties for this contact -->
          {% for take2 in contact.take2 %}
            {% if take2.has_data %}
              <hr>
              {% if take2.class_name == 'Contact' %}
                {% for data in take2.data %}
                  <a id="contact_link" href="/search?key={{data.key}}">{{data.data}}</a>
                  {% if not forloop.last %}
                    ,&nbsp;
                  {% endif%}
                {% endfor %}
              {% else %}
                <ul>
                  {% for data in take2.data %}
                    <li>{{data.data}}</li>
                  {% endfor %}
                </ul>
              {% endif %}
            {% endif %}
          {% endfor %}
        </article>
      {% endfor %}
    {% else %}
      {% if signed_in %}
        <header>
          {% if query %}
              <h1>Nothing found for {{ query|escape }}</h1>
          {% else %}
          {% endif %}
        <header>
      {% endif %}
    {% endif %}
    {% if not query %}
      <div style="width: 300px; height: 30px;"></div>
      <h2>This is your main page at Weschnitz!</h2>
      <h3>What you can do from here:</h3>
        <ul>
            <li>Your personal data is being displayed above. You can edit or extend it by adding phone numers, a new address etc.</li>
            <li>Enter more of your friend's addresses. Use the 'New contact' menu entry in the upper right corner.</li>
        </ul>
    {% endif %}
  <footer>
  </footer>
{% endblock %}
