{% extends "take2baseclass.html" %}

{% block content %}
    <script type="text/javascript">
        $(document).ready(function() {

          // make attic entries disappear
          $('div.take2_data_attic').hide();
          $('div.take2_section .take2_header_toggle').click(function(){
              var section = $(this).parents('div.take2_section');
              $("div.take2_data_attic", section).toggle()
          });
        });
    </script>

    {% for error in errors %}
        <div class="error">{{ error }}</div>
    {% endfor %}

    <header>
      <h1>Manage contact details</h1>
    </header>


    <article id="results">
      <header style="padding: 10px 0px 10px 0px;">
        <aside class="contact_edit">
          {% if contact.attic %}
              <a href="javascript:post_to_url('/deatticcontact', {'key': '{{contact.key}}' } );">Undelete</a>
          {% else %}
              <a href="javascript:void(0)" onClick="post_to_url('/atticcontact', {'key': '{{contact.key}}'});">Delete</a>
          {% endif %}
        </aside>
        <h2>
          <a href="javascript:void(0)" onClick="post_to_url('/editperson', {'key': '{{contact.key}}'});">
            {{ contact.name }}
            {% if contact.nickname %}
                ({{contact.nickname}})
            {% endif %}
            {{contact.lastname}}
            {% if contact.birthday %}
                &nbsp;*{{contact.birthday}} {{contact.birthmonth}}
            {% endif %}
          </a>
        </h2>
        {% for relation in contact.relations %}
          <h3>
            {{relation}}
          </h3>
        {% endfor %}
      </header>
      <!-- properties for this contact -->
      {% for take2 in contact.take2 %}
        <div class="take2_section">
          <div class="take2_header">
            <div>
              <a href="javascript:void(0)" onClick="post_to_url('/edittake2', {'action': 'new', 'instance': '{{take2.class_name}}', 'key': '{{contact.key}}' });">
                  <img class="take2_header_icon" src="/static/icon-new.png" alt="New">
              </a>
              <a class="take2_header_text" href="javascript:void(0)" onClick="post_to_url('/edittake2', {'action': 'new', 'instance': '{{take2.class_name}}', 'key': '{{contact.key}}' });">
                <h3> {{take2.header}}</h3>
              </a>
            </div>
            <div style="height: 10px"></div>
            <a class="take2_header_toggle" href="javascript:void(0)">
                <img class="take2_header_icon" src="/static/icon-undelete.png" alt="New">
            </a>
            <a class="take2_header_toggle" href="javascript:void(0)">
              Show/hide deleted items
            </a>
          </div>
          <div style="height: 10px"></div>
          <ul>
            {% for data in take2.data %}
              {% if data.attic %}
                <div class="take2_data_attic">
              {% else %}
                <div class="take2_data">
              {% endif %}
                <aside class="contact_edit">
                  {% if data.attic %}
                      <a href="javascript:post_to_url('/deattictake2', {'instance': '{{data.class_name}}', 'key': '{{data.key}}' } );">Undelete</a>
                  {% else %}
                      <a href="javascript:void(0)" onClick="post_to_url('/attictake2', {'instance': '{{data.class_name}}', 'key': '{{data.key}}'});">Delete</a>
                  {% endif %}
                </aside>
                <li>
                  <a href="javascript:void(0)" onClick="post_to_url('/edittake2', {'action': 'edit', 'instance': '{{data.class_name}}', 'key': '{{data.key}}' });">
                      {{data.data}}
                  </a>
                </li>
              </div>
            {% endfor %}
          </ul>
        </div> <!-- take2_section -->
      {% endfor %}
    </article>
{% endblock %}
